import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'app-actualites',
  templateUrl: './actualites.component.html',
  styleUrls: ['./actualites.component.css']
})
export class ActualitesComponent implements OnInit {
  newPostContent: string = '';
  currentFilter: string = 'all';
  loading: boolean = true;
  posts: any[] = [
    {
      id: 1,
      author: {
        name: 'Lamah Richard',
        avatar: 'assets/users/richard.jpg',
        role: 'Charg√© de communication'
      },
      date: new Date('2023-05-15T14:30:00'),
      content: 'Superbe journ√©e lors de notre dernier atelier de dessin du BDA ! Merci √† tous les participants pour cette √©nergie incroyable.',
      images: ['assets/actualites/a1.jpg'],
      likes: 24,
      comments: [
        {
          author: { name: 'Onion POPO', avatar: 'assets/users/onionpopo.jpg' },
          text: 'C\'√©tait vraiment g√©nial, merci pour l\'organisation !',
          date: new Date('2023-05-15T15:45:00')
        },
        {
          author: { name: 'Fono', avatar: 'assets/users/colince.jpg' },
          text: "L'ambiance √©tait incroyable, on se serait cru au Maroc ! H√¢te de participer √† la prochaine √©dition.",
          date: new Date('2023-05-15T16:30:00')
        }
      ],
      tags: ['#√©changeculturel', '#danse'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 2,
      author: {
        name: 'Bureau des √âtudiants',
        avatar: 'assets/partners/bde.png',
        role: 'Organisation'
      },
      date: new Date('2023-05-10T09:15:00'),
      content: 'üì¢ COMMUNIQU√â OFFICIEL : La prochaine r√©union interculturelle aura lieu vendredi 19 mai √† 18h en salle B12.',
      likes: 56,
      comments: [
        {
          author: { name: 'Delphine TOVIEGBE', avatar: 'assets/users/delphine.png' },
          text: "Nous comptons sur une pr√©sence massive ! Ce festival sera l'occasion de mettre en avant la diversit√© culturelle de notre √©cole.",
          date: new Date('2023-05-10T10:00:00')
        },
        {
          author: { name: 'R√©mi Raoul', avatar: 'assets/users/remi.jpg' },
          text: 'Je vais pr√©parer la partie budget, tout doit √™tre pr√™t pour cette r√©union importante.',
          date: new Date('2023-05-10T11:15:00')
        }
      ],
      tags: ['#annonce'],
      type: 'announcement',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 3,
      author: {
        name: 'Picasso',
        avatar: 'assets/users/picasso.png',
        role: 'Vice-pr√©sident'
      },
      date: new Date('2023-05-12T16:00:00'),
      content: 'Une belle journ√©e de pr√©paration pour nos prochains √©v√©nements ! On compte sur votre participation et vos id√©es pour enrichir notre programme. #collaboration #cr√©ativit√©',
      likes: 32,
      comments: [
        {
          author: { name: 'Marouan', avatar: 'assets/users/marouan.jpg' },
          text: "Un plaisir de collaborer avec tout le monde ! Les id√©es fusent, et j'ai h√¢te de voir ce que nous allons proposer ensemble.",
          date: new Date('2023-05-12T16:45:00')
        },
        {
          author: { name: 'Fono', avatar: 'assets/users/colince.jpg' },
          text: "Les √©v√©nements √† venir promettent d'√™tre g√©niaux, je suis super excit√© par ce qu'on pr√©pare !",
          date: new Date('2023-05-12T17:30:00')
        }
      ],
      tags: ['#collaboration', '#cr√©ativit√©'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 4,
      author: {
        name: 'Fono',
        avatar: 'assets/users/colince.jpg',
        role: 'Charg√© des √©v√©nements'
      },
      date: new Date('2023-05-16T11:45:00'),
      content: "Un grand merci √† tous ceux qui ont particip√© √† la comp√©tition de dessin organis√©e par le BDA ! J'ai eu l'honneur de remporter le second prix, mais c'est l'esprit de comp√©tition et la cr√©ativit√© qui m'ont le plus marqu√©. Bravo √† tous ! #comp√©tition #cr√©ativit√©",
      images: ['assets/actualites/a3.jpg'],
      likes: 18,
      comments: [
        {
          author: { name: 'Delphine TOVIEGBE', avatar: 'assets/users/delphine.png' },
          text: 'Bravo Fono, un bel esprit de partage et de cr√©ativit√© ! H√¢te de voir tes futurs projets !',
          date: new Date('2023-05-16T12:30:00')
        },
        {
          author: { name: 'R√©mi Raoul', avatar: 'assets/users/remi.jpg' },
          text: 'F√©licitations Fono, ce prix est bien m√©rit√© ! Une belle repr√©sentation de notre culture visuelle.',
          date: new Date('2023-05-16T13:00:00')
        }
      ],
      tags: ['#comp√©tition', '#cr√©ativit√©'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 5,
      author: {
        name: 'Delphine TOVIEGBE',
        avatar: 'assets/users/delphine.png',
        role: 'Pr√©sidente'
      },
      date: new Date('2023-05-18T14:00:00'),
      content: 'Notre √©quipe a mis tout son c≈ìur dans la pr√©paration des √©v√©nements √† venir. Ensemble, nous allons faire briller la culture ! Merci √† tous pour votre investissement. #√©quipe #passion',
      likes: 40,
      comments: [
        {
          author: { name: 'Picasso', avatar: 'assets/users/picasso.png' },
          text: "Merci Delphine pour ton leadership et ta vision, c'est gr√¢ce √† toi que tout se passe bien.",
          date: new Date('2023-05-18T15:00:00')
        },
        {
          author: { name: 'Marouan', avatar: 'assets/users/marouan.jpg' },
          text: "Une √©quipe au top ! J'ai h√¢te de partager ces moments avec vous tous.",
          date: new Date('2023-05-18T15:45:00')
        }
      ],
      tags: ['#√©quipe', '#passion'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 6,
      author: {
        name: 'Marouan',
        avatar: 'assets/users/marouan.jpg',
        role: 'Charg√© des relations ext√©rieures'
      },
      date: new Date('2023-05-14T10:00:00'),
      content: "Rencontre enrichissante avec plusieurs associations culturelles pour discuter de futures collaborations. Carrefour de Culture ne cesse d'√©largir son r√©seau ! #partenariats #r√©seautage",
      likes: 28,
      comments: [
        {
          author: { name: 'Picasso', avatar: 'assets/users/picasso.png' },
          text: "√áa va √™tre g√©nial d'avoir plus de collaborations externes. De grandes opportunit√©s √† venir !",
          date: new Date('2023-05-14T11:15:00')
        }
      ],
      tags: ['#partenariats', '#r√©seautage'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 7,
      author: {
        name: 'R√©mi Raoul',
        avatar: 'assets/users/remi.jpg',
        role: 'Tr√©sorier'
      },
      date: new Date('2023-05-13T09:30:00'),
      content: 'La gestion financi√®re du projet avance bien ! Le budget pour le festival des cultures est quasiment finalis√©. Restons organis√©s pour garantir le succ√®s de notre √©v√©nement ! #gestion #finance',
      likes: 22,
      comments: [
        {
          author: { name: 'Fono', avatar: 'assets/users/colince.jpg' },
          text: 'Merci R√©mi pour ton travail impeccable. Nous serons pr√™ts pour le festival.',
          date: new Date('2023-05-13T10:30:00')
        }
      ],
      tags: ['#gestion', '#finance'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 8,
      author: {
        name: 'Ecole EILCO',
        avatar: 'assets/partners/eilco.png',
        role: 'Institution'
      },
      date: new Date('2023-05-19T10:00:00'),
      content: 'Lancement officiel des activit√©s culturelles du semestre ! Venez nombreux aux √©v√©nements organis√©s par les associations √©tudiantes, notamment le festival des cultures le 25 mai. #vie√©tudiante #√©v√©nements',
      likes: 75,
      comments: [
        {
          author: { name: 'Picasso', avatar: 'assets/users/picasso.png' },
          text: "Ce sera une superbe occasion de d√©couvrir de nouvelles cultures. J'ai h√¢te !",
          date: new Date('2023-05-19T10:30:00')
        },
        {
          author: { name: 'Delphine TOVIEGBE', avatar: 'assets/users/delphine.png' },
          text: "Un √©v√©nement √† ne pas manquer ! Toute l'√©quipe est pr√™te √† faire de ce festival un grand succ√®s.",
          date: new Date('2023-05-19T11:00:00')
        }
      ],
      tags: ['#vie√©tudiante', '#√©v√©nements'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 9,
      author: {
        name: 'Carrefour de Culture',
        avatar: 'assets/logo.jpg',
        role: 'Association √âtudiante'
      },
      date: new Date('2023-05-20T10:00:00'),
      content: 'üéâ Suivez-nous sur Instagram ! üì≤ Retrouvez toutes nos actualit√©s, √©v√©nements et moments forts en images ! Ne manquez rien de notre belle aventure culturelle. #suiveznous #r√©seauxsociaux #CarrefourDeCulture',
      images: ['assets/actualites/insta.png'],
      likes: 120,
      comments: [
        {
          author: { name: 'Fono', avatar: 'assets/users/colince.jpg' },
          text: 'On va poster des photos de nos √©v√©nements les plus fous, suivez-nous !',
          date: new Date('2023-05-20T11:30:00')
        },
        {
          author: { name: 'Delphine TOVIEGBE', avatar: 'assets/users/delphine.png' },
          text: 'Le contenu que nous allons partager va √™tre incroyable ! Suivez-nous pour d√©couvrir des moments inoubliables.',
          date: new Date('2023-05-20T12:00:00')
        }
      ],
      tags: ['#suiveznous', '#r√©seauxsociaux', '#CarrefourDeCulture'],
      type: 'announcement',
      liked: false,
      saved: false,
      showComments: true
    },
    {
      id: 10,
      author: {
        name: "OnionPOPO",
        avatar: "assets/users/onionpopo.jpg",
        role: "Membre Philosophe"
      },
      date: new Date("2025-04-12T15:30:00"),
      content: "üåø La v√©rit√© se cache dans l'invisible. Si l'asso √©tait une question, qu‚Äôest-ce que la r√©ponse ? On parle souvent d‚Äôavancer ensemble, mais peut-√™tre qu‚Äôon avance tout en restant immobiles. N‚Äôest-ce pas l√† le paradoxe de notre qu√™te commune ? #R√©flexion #ParadoxeCollectif #V√©rit√©Invisible",
      images: ["assets/actualites/onion.png"],
      likes: 85,
      comments: [
        {
          author: { name: "R√©mi", avatar: "assets/users/remi.jpg" },
          text: "Peut-√™tre que la r√©ponse, c'est d'accepter de ne pas en avoir. Le chemin lui-m√™me est ce qui compte.",
          date: new Date("2025-04-12T16:00:00")
        },
        {
          author: { name: "Fono", avatar: "assets/users/colince.jpg" },
          text: "On pourrait m√™me dire que la qu√™te est un jeu entre le mouvement et l‚Äôimmobilit√©. Est-ce qu‚Äôon cherche vraiment, ou est-ce que c‚Äôest l‚Äôid√©e de chercher qui nous d√©finit ?",
          date: new Date("2025-04-12T16:30:00")
        },
        {
          author: { name: "Richard", avatar: "assets/users/richard.jpg" },
          text: "C‚Äôest une perspective int√©ressante. Si la qu√™te est un paradoxe, alors peut-√™tre que chaque √©tape nous rapproche plus de l‚Äôincompr√©hension que de la certitude.",
          date: new Date("2025-04-12T17:00:00")
        }
      ],
      tags: ['#R√©flexion', '#ParadoxeCollectif', '#V√©rit√©Invisible'],
      type: 'event',
      liked: false,
      saved: false,
      showComments: true
    }
  ];
  

  constructor() { }

  ngOnInit(): void {
    setTimeout(() => {
      this.posts.sort((a, b) => b.date - a.date);
      this.loading = false;
    }, 1000);
  }

  publishPost(): void {
    if (this.newPostContent.trim()) {
      const newPost = {
        id: this.posts.length + 1,
        author: {
          name: 'Vous',
          avatar: 'assets/logo.jpg',
          role: 'Membre'
        },
        date: new Date(),
        content: this.newPostContent,
        likes: 0,
        comments: [],
        tags: [],
        type: 'post',
        liked: false,
        saved: false,
        showComments: false
      };
      
      this.posts.unshift(newPost);
      this.newPostContent = '';
    }
  }

  addComment(post: any, commentText: string): void {
    if (commentText.trim()) {
      post.comments.push({
        author: {
          name: 'Vous',
          avatar: 'assets/logo.jpg'
        },
        text: commentText,
        date: new Date()
      });
    }
  }

  toggleComments(post: any): void {
    post.showComments = !post.showComments;
  }

  likePost(post: any): void {
    post.liked = !post.liked;
    post.likes += post.liked ? 1 : -1;
  }

  savePost(post: any): void {
    post.saved = !post.saved;
  }

  sharePost(post: any): void {
    // Impl√©mentation r√©elle utiliserait les API de partage
    console.log('Partage du post:', post.id);
    alert(`Post "${post.content.substring(0, 30)}..." partag√©!`);
  }

  filterPosts(type: string): void {
    this.currentFilter = type;
  }

  get filteredPosts() {
    if (this.currentFilter === 'all') return this.posts;
    return this.posts.filter(post => post.type === this.currentFilter);
  }
}